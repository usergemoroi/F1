# Обновление оффсетов PUBG Mobile

## Выполненные задачи

### 1. Распаковка исходников
- Распакован архив PUBG3.rar
- Исходный код перенесен в корень проекта

### 2. Создание централизованного файла оффсетов
- Автоматическое определение архитектуры (32-bit/64-bit)
- Все оффсеты из прикрепленных файлов включены
- Поддержка обеих архитектур iOS

#### Включенные оффсеты (всего 140+ оффсетов):
- Игровые: CurrentWeapon, GameState, PlayerController и т.д.
- Персонажа: Health, TeamId, Position, Mesh и т.д.
- Оружия: ShootWeaponComponent, BulletFireSpeed, RecoilKickADS и т.д.
- Транспорта: HP, Fuel, VehicleMovement и т.д.
- UI/Camera: CameraCache, ScopeFov, PlayerCameraManager и т.д.
- Avatar: AvatarComponent2, NetAvatarData, SynData и т.д.

### 3. Обновление исходного кода

#### Добавлен include:
```cpp
#include "../../Offsets.h"
```

#### Заменены хардкоженные оффсеты:
1. **Строка 4490**: `0xa0` → `ActorsArray`
   - Для получения массива акторов из PersistentLevel

2. **Строка 5598**: `0x668` → `DeadBoxAvatarComponent`
   - Для доступа к компоненту аватара мертвого игрока (TombBox)

3. **Строка 7061**: `0x388` → `NetAvatarData`
   - Для доступа к данным синхронизации аватара
   - 32-bit: 0x300
   - 64-bit: 0x3E8

### 4. Преимущества новой архитектуры

#### Maintainability (Поддерживаемость):
- Все оффсеты в одном месте
- Легко обновлять при выходе новых версий игры

#### Cross-platform (Кроссплатформенность):
- Автоматический выбор правильных оффсетов на основе архитектуры
- Не нужно менять код при компиляции под разные платформы

#### Readability (Читаемость):
- Именованные константы вместо магических чисел
- Понятные имена переменных

#### Scalability (Масштабируемость):
- Легко добавлять новые оффсеты
- Можно добавлять комментарии и документацию

### 5. Дополнительные улучшения
- Создан файл .gitignore для корректной работы с git
- Удалены системные файлы macOS (__MACOSX)
- Удалена временная директория packages
- Создана документация (OFFSETS_UPDATE.md)

## Файлы для будущих обновлений

1. Получите новые оффсеты (с помощью дизассемблера или других инструментов)
2. Обновите только файл **Offsets.h**
3. Больше не нужно искать и менять оффсеты по всему коду
4. Пересоберите проект

## Технические детали

### Определение архитектуры:
```cpp
#if defined(__LP64__) || defined(_WIN64)
    #define IS_64BIT 1
#else
    #define IS_64BIT 0
#endif
```

### Пример использования:
```cpp
// Старый код:
FNetAvatarSyncData NetAvatarComp = *(FNetAvatarSyncData *)((uintptr_t) AvatarComp + 0x388);

// Новый код:
FNetAvatarSyncData NetAvatarComp = *(FNetAvatarSyncData *)((uintptr_t) AvatarComp + NetAvatarData);
```

## Статус
 Все задачи выполнены
 Исходники распакованы
 Оффсеты обновлены
 Код рефакторен
 Документация создана
